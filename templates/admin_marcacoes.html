{% extends "base.html" %}
{% block title %}Gest√£o de Marca√ß√µes ‚Ä¢ {{ super() }}{% endblock %}

{% block content %}
<section class="page-hero soft-gradient">
  <div class="container text-center">
    <h1 class="mb-3 font-semibold text-4xl text-gray-800 tracking-tight">Gest√£o de Marca√ß√µes</h1>
    <p class="text-gray-600 text-sm">Acompanhe, aprove e rejeite marca√ß√µes de forma organizada e elegante.</p>
  </div>
</section>

<section class="section container">
  <div class="admin-panel shadow-2xl bg-white/80 backdrop-blur-md rounded-3xl p-10 border border-pink-100">

    <!-- üîç FILTROS -->
    <form method="GET" action="{{ url_for('admin_marcacoes') }}" class="filter-bar">
      <div class="filter-left">
        <label for="estado" class="label">Estado:</label>
        <select id="estado" name="estado" class="select">
          <option value="">Todos</option>
          <option value="Pendente" {% if request.args.get('estado') == 'Pendente' %}selected{% endif %}>Pendentes</option>
          <option value="Aprovado" {% if request.args.get('estado') == 'Aprovado' %}selected{% endif %}>Aprovados</option>
          <option value="Rejeitado" {% if request.args.get('estado') == 'Rejeitado' %}selected{% endif %}>Rejeitados</option>
        </select>
      </div>

      <div class="filter-right">
        <input
          type="text"
          name="q"
          placeholder="üîç Pesquisar por cliente ou servi√ßo..."
          value="{{ request.args.get('q', '') }}"
          class="search"
        />
        <button type="submit" class="btn-search">Filtrar</button>
      </div>
    </form>

    <!-- üìã TABELA -->
    <div class="table-container">
      <table class="admin-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Cliente</th>
            <th>Servi√ßo</th>
            <th>Data/Hora</th>
            <th>Estado</th>
            <th>Obs.</th>
            <th class="center">A√ß√µes</th>
          </tr>
        </thead>
        <tbody>
          {% if marcacoes %}
            {% for m in marcacoes %}
            <tr>
              <td>{{ loop.index }}</td>
              <td>{{ m[1] }}</td>
              <td>{{ m[2] }}</td>
              <td>{{ m[3].strftime('%d/%m/%Y %H:%M') }}</td>
              <td>
                {% if m[4] == 'Aprovado' %}
                  <span class="estado aprovado">‚óè Aprovado</span>
                {% elif m[4] == 'Rejeitado' %}
                  <span class="estado rejeitado">‚óè Rejeitado</span>
                {% else %}
                  <span class="estado pendente">‚óè Pendente</span>
                {% endif %}
              </td>
              <td class="obs">{{ m[5] or '‚Äî' }}</td>
              <td class="center">
                <div class="acoes">
                  <form method="POST" action="{{ url_for('admin_update_marcacao') }}">
                    <input type="hidden" name="id" value="{{ m[0] }}">
                    <input type="hidden" name="acao" value="Aprovado">
                    <button class="btn approve" type="submit">‚úÖ Aprovar</button>
                  </form>
                  <form method="POST" action="{{ url_for('admin_update_marcacao') }}">
                    <input type="hidden" name="id" value="{{ m[0] }}">
                    <input type="hidden" name="acao" value="Rejeitado">
                    <button class="btn reject" type="submit">‚úñ Rejeitar</button>
                  </form>
                </div>
              </td>
            </tr>
            {% endfor %}
          {% else %}
            <tr><td colspan="7" class="no-results">Nenhuma marca√ß√£o encontrada.</td></tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </div>
</section>

<style>
/* üîπ HERO */
.soft-gradient {
  background: linear-gradient(135deg, #ffeaf4, #ffd8eb);
  padding: 3.5rem 1rem 2.5rem;
}

/* üîπ PAINEL */
.admin-panel {
  margin-top: 2rem;
  display: flex;
  flex-direction: column;
  gap: 2rem;
}

/* üîπ FILTROS */
.filter-bar {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  gap: 1.2rem;
  align-items: center;
}
.filter-left, .filter-right {
  display: flex;
  align-items: center;
  gap: 0.8rem;
}
.label {
  font-weight: 600;
  color: #444;
}
.select, .search {
  padding: 10px 14px;
  border-radius: 12px;
  border: 1px solid #ddd;
  outline: none;
  font-size: 0.95rem;
  background: #fff;
  transition: border-color 0.2s, box-shadow 0.2s;
}
.select:hover, .search:hover {
  border-color: #f472b6;
}
.search {
  min-width: 270px;
}
.btn-search {
  background: linear-gradient(90deg, #ec4899, #f472b6);
  color: white;
  border: none;
  padding: 10px 18px;
  border-radius: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.25s ease;
}
.btn-search:hover {
  opacity: 0.9;
  transform: translateY(-1px);
}

/* üîπ TABELA */
.table-container {
  overflow-x: auto;
  background: white;
  border-radius: 16px;
  border: 1px solid #fbcfe8;
  padding: 1rem;
}
.admin-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0 10px;
}
.admin-table th {
  text-align: left;
  padding: 14px 16px;
  font-size: 0.9rem;
  color: #444;
  text-transform: uppercase;
  background: #ffe4ec;
  font-weight: 700;
}
.admin-table td {
  padding: 14px 16px;
  background: #fff;
  border-bottom: 1px solid #f2f2f2;
  font-size: 0.95rem;
  color: #333;
}
.admin-table tr:hover td {
  background-color: #fff5f8;
}
.center {
  text-align: center;
}

/* üîπ ESTADOS */
.estado {
  padding: 6px 14px;
  border-radius: 20px;
  font-weight: 600;
  font-size: 0.85rem;
  display: inline-block;
}
.estado.aprovado {
  color: #15803d;
  background-color: #dcfce7;
}
.estado.rejeitado {
  color: #b91c1c;
  background-color: #fee2e2;
}
.estado.pendente {
  color: #92400e;
  background-color: #fef3c7;
}

/* üîπ A√á√ïES */
.acoes {
  display: flex;
  justify-content: center;
  gap: 0.5rem;
}
.btn {
  border: none;
  padding: 8px 14px;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
}
.btn.approve {
  background-color: #16a34a;
  color: white;
  box-shadow: 0 2px 6px rgba(22, 163, 74, 0.25);
}
.btn.approve:hover {
  background-color: #15803d;
}
.btn.reject {
  background-color: white;
  color: #b91c1c;
  border: 2px solid #fca5a5;
}
.btn.reject:hover {
  background-color: #fee2e2;
}
.no-results {
  text-align: center;
  padding: 2rem 0;
  color: #777;
  font-style: italic;
}
</style>
{% endblock %}
