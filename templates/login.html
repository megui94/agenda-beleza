{% extends "base.html" %}
{% block title %}Iniciar Sessão • {{ super() }}{% endblock %}

{% block content %}
<section class="page-hero">
  <div class="container">
    <h1>Iniciar Sessão</h1>
    <p>Aceda à sua conta para gerir as suas marcações e informações pessoais.</p>
  </div>
</section>

<section class="section container" style="max-inline-size: 480px;">
  <form class="form card form-login" method="POST" action="{{ url_for('login') }}">
    
    <div class="form-row">
      <label for="email">E-mail</label>
      <input id="email" name="email" type="email" required placeholder="exemplo@gmail.com" autocomplete="email">
    </div>

    <div class="form-row password-field">
      <label for="password">Senha</label>
      <div class="input-with-icon">
        <input id="password" name="password" type="password" required placeholder="••••••••" autocomplete="current-password">
        <button type="button" class="toggle-password" aria-label="Mostrar ou ocultar senha">
          👁️
        </button>
      </div>
    </div>

    <div class="form-row link-row">
      <a href="{{ url_for('reset_request') }}" class="link">Esqueceu a senha?</a>
    </div>

    <button class="btn btn-primary w-full" type="submit">Entrar</button>

    <p class="register-prompt">
      Ainda não tem conta?
      <a href="{{ url_for('registar') }}">Registe-se agora</a>
    </p>
  </form>
</section>

<!-- 🌿 Script para mostrar/ocultar senha -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const toggle = document.querySelector(".toggle-password");
  const input = document.getElementById("password");

  toggle.addEventListener("click", () => {
    const isHidden = input.type === "password";
    input.type = isHidden ? "text" : "password";
    toggle.textContent = isHidden ? "🙈" : "👁️";
  });
});
</script>

<style>
/* --- Melhoria visual do campo de senha --- */
.input-with-icon {
  position: relative;
  display: flex;
  align-items: center;
}
.input-with-icon input {
  inline-size: 100%;
  padding-inline-end: 2.5rem;
}
.toggle-password {
  position: absolute;
  inset-inline-end: 0.75rem;
  background: none;
  border: none;
  cursor: pointer;
  font-size: 1.1rem;
  opacity: 0.7;
  transition: opacity 0.2s ease;
}
.toggle-password:hover {
  opacity: 1;
}

/* --- Alinhamento e estilo --- */
.form-login {
  margin: 0 auto;
  padding: 2rem;
  background: var(--card-bg, #fff);
  border-radius: 1.25rem;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
}

.form-login .link-row {
  text-align: end;
  margin-block-start: -0.5rem;
  margin-block-end: 1rem;
}

.form-login .register-prompt {
  text-align: center;
  margin-block-start: 1.5rem;
  color: #555;
}

.form-login .register-prompt a {
  color: var(--accent-color, #d05c91);
  font-weight: 600;
}

.w-full {
  inline-size: 100%;
}
</style>
{% endblock %}
